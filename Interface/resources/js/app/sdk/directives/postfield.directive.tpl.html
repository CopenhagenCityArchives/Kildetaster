<section>
    <h4>{{data.label}}</h4>

    <div class="postfield" ng-repeat="field in data.fields">

        <div ng-if="!isArray(field) && (field.value || (!field.value && errorReporting))" ng-class="{
            error: field.error,
            reporting: field.showErrorForm
        }">

            <strong>{{field.label}}</strong>
            <span ng-hide="errorReporting && !field.error">{{field.value || 'Ingen v√¶rdi'}}</span>

            <a href ng-if="errorReporting && !field.error" class="postfield__report-link" ng-class="{ postfield__reporting: field.showErrorForm }" ng-click="toggleErrorReporting(field)">
                <span>{{field.value || 'Dette felt er ikke udfyldt'}}</span>
                <i class="sdk-icon pencil"></i>
            </a>

            <span ng-if="field.error">
                <i class="sdk-icon report-error" title="{{field.error.comment}}"></i>
            </span>

            <div class="error-reporting text-center" ng-if="field.errorAccepted">
                <i class="sdk-icon green-checkmark"></i>
                <div>Tak for din fejlmelding</div>
            </div>

            <div class="error-reporting" ng-if="errorReporting && field.showErrorForm">
                <div class="row-fluid">
                    <div class="span12">
                        <textarea ng-model="field.comment"></textarea>
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="span12 text-right">
                        <button class="button" ng-click="doReport(data, field)">Indberet fejl</button>
                        <a href ng-click="toggleErrorReporting(field)">Fortryd</a>
                    </div>
                </div>
            </div>

        </div>

        <div ng-if="isArray(field) && (field[0].value || (!field[0].value && errorReporting))" ng-class="{ error: field[0].error }">
            <span ng-hide="errorReporting && !field[0].error">{{field[0].value}}</span>

            <a href ng-if="errorReporting && !field[0].error" class="postfield__report-link"  ng-click="toggleErrorReporting(field[0])">
                <span>{{field[0].value}}</span>
                <i class="sdk-icon pencil"></i>
            </a>

            <span ng-if="field[0].error">
                <i class="sdk-icon report-error" title="{{field[0].error.comment}}"></i>
            </span>

            <div class="error-reporting text-center" ng-if="field[0].errorAccepted">
                <i class="sdk-icon green-checkmark"></i>
                <div>Din feedback er sendt</div>
            </div>

            <div class="error-reporting" ng-if="errorReporting && field[0].showErrorForm">
                <div class="row-fluid">
                    <div class="span12">
                        <textarea ng-model="field[0].comment"></textarea>
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="span12 text-right">
                        <button class="button" ng-click="doReport(data, field[0])">Indberet fejl</button>
                        <a href ng-click="toggleErrorReporting(field[0])">Fortryd</a>
                    </div>
                </div>
            </div>

        </div>

    </div>

    <hr>
</section>
